2025-10-19 23:36:28,018 ERROR Unhandled: (sqlite3.OperationalError) no such column: txn.category_enc
[SQL: SELECT txn.id, txn.ts, txn.kind, txn.amount, txn.category_enc, txn.memo_enc 
FROM txn]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: txn.category_enc

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 187, in __call__
    recv_stream.close()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 135, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/Users/naijal/Projects/project_z/main.py", line 252, in dispatch
    resp = await call_next(request)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 159, in call_next
    raise app_exc
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 187, in __call__
    recv_stream.close()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 135, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/Users/naijal/Projects/project_z/main.py", line 215, in dispatch
    resp: Response = await call_next(request)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 159, in call_next
    raise app_exc
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/fastapi/routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/fastapi/routing.py", line 109, in app
    response = await f(request)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/fastapi/routing.py", line 389, in app
    raw_response = await run_endpoint_function(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/fastapi/routing.py", line 290, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    return await future
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    result = context.run(func, *args)
  File "/Users/naijal/Projects/project_z/main.py", line 399, in analyze
    inc, exp, net = _sum_all(s)
  File "/Users/naijal/Projects/project_z/main.py", line 317, in _sum_all
    txns = s.exec(stmt).all()
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlmodel/orm/session.py", line 83, in exec
    results = super().execute(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
    return self._execute_internal(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: txn.category_enc
[SQL: SELECT txn.id, txn.ts, txn.kind, txn.amount, txn.category_enc, txn.memo_enc 
FROM txn]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-10-19 23:37:06,928 ERROR Unhandled: (sqlite3.OperationalError) no such column: txn.category_enc
[SQL: SELECT txn.id, txn.ts, txn.kind, txn.amount, txn.category_enc, txn.memo_enc 
FROM txn]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: txn.category_enc

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 187, in __call__
    recv_stream.close()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 135, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/Users/naijal/Projects/project_z/main.py", line 252, in dispatch
    resp = await call_next(request)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 159, in call_next
    raise app_exc
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 187, in __call__
    recv_stream.close()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 135, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/Users/naijal/Projects/project_z/main.py", line 215, in dispatch
    resp: Response = await call_next(request)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 159, in call_next
    raise app_exc
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/fastapi/routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/fastapi/routing.py", line 109, in app
    response = await f(request)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/fastapi/routing.py", line 389, in app
    raw_response = await run_endpoint_function(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/fastapi/routing.py", line 290, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    return await future
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    result = context.run(func, *args)
  File "/Users/naijal/Projects/project_z/main.py", line 399, in analyze
    inc, exp, net = _sum_all(s)
  File "/Users/naijal/Projects/project_z/main.py", line 317, in _sum_all
    txns = s.exec(stmt).all()
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlmodel/orm/session.py", line 83, in exec
    results = super().execute(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
    return self._execute_internal(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/naijal/Projects/project_z/venv/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: txn.category_enc
[SQL: SELECT txn.id, txn.ts, txn.kind, txn.amount, txn.category_enc, txn.memo_enc 
FROM txn]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-10-19 23:46:04,299 INFO POST /api/load_sample 404 127.0.0.1 5480
2025-10-19 23:46:04,313 INFO GET /api/metrics 200 127.0.0.1 5480
2025-10-19 23:46:04,331 INFO GET /api/analyze 200 127.0.0.1 5480
2025-10-19 23:46:33,201 INFO GET /api/analyze 200 127.0.0.1 5480
2025-10-19 23:47:20,704 INFO GET /api/analyze 200 127.0.0.1 5480
2025-10-19 23:50:07,638 INFO OPTIONS /api/analyze 200 127.0.0.1 none
2025-10-19 23:50:07,659 INFO GET /api/analyze 200 127.0.0.1 5480
2025-10-19 23:50:39,207 INFO GET /api/analyze 401 127.0.0.1 none
2025-10-19 23:51:26,068 INFO GET /api/analyze 200 127.0.0.1 5480
2025-10-19 23:51:48,096 INFO GET /api/analyze 200 127.0.0.1 5480
2025-10-19 23:52:08,951 INFO GET /api/analyze 200 127.0.0.1 5480
2025-10-19 23:54:16,000 INFO OPTIONS /api/metrics 200 127.0.0.1 none
2025-10-19 23:54:16,000 INFO OPTIONS /api/timeseries 200 127.0.0.1 none
2025-10-19 23:54:16,004 INFO GET /api/timeseries 200 127.0.0.1 5480
2025-10-19 23:54:16,004 INFO GET /api/metrics 200 127.0.0.1 5480
2025-10-19 23:54:16,007 INFO GET /api/timeseries 200 127.0.0.1 5480
2025-10-19 23:54:16,007 INFO GET /api/metrics 200 127.0.0.1 5480
2025-10-19 23:54:32,888 INFO GET /api/metrics 200 127.0.0.1 5480
2025-10-19 23:54:32,889 INFO GET /api/timeseries 200 127.0.0.1 5480
2025-10-19 23:54:32,892 INFO GET /api/metrics 200 127.0.0.1 5480
2025-10-19 23:54:32,893 INFO GET /api/timeseries 200 127.0.0.1 5480
2025-10-19 23:54:46,769 INFO GET /api/analyze 200 127.0.0.1 5480
2025-10-19 23:54:46,780 INFO GET /api/metrics 200 127.0.0.1 5480
2025-10-19 23:54:46,781 INFO GET /api/timeseries 200 127.0.0.1 5480
2025-10-19 23:54:47,927 INFO GET /api/analyze 200 127.0.0.1 5480
2025-10-19 23:54:47,935 INFO GET /api/metrics 200 127.0.0.1 5480
2025-10-19 23:54:47,936 INFO GET /api/timeseries 200 127.0.0.1 5480
2025-10-19 23:54:50,952 INFO OPTIONS /api/suggest 200 127.0.0.1 none
2025-10-19 23:54:50,970 INFO GET /api/suggest 200 127.0.0.1 5480
2025-10-19 23:55:43,516 INFO GET /api/suggest 200 127.0.0.1 5480
2025-10-19 23:58:14,472 INFO GET /api/metrics 200 127.0.0.1 5480
2025-10-19 23:58:14,472 INFO GET /api/timeseries 200 127.0.0.1 5480
2025-10-19 23:58:14,476 INFO GET /api/metrics 200 127.0.0.1 5480
2025-10-19 23:58:14,476 INFO GET /api/timeseries 200 127.0.0.1 5480
2025-10-20 00:04:35,417 INFO GET /api/metrics 200 127.0.0.1 5480
2025-10-20 00:04:35,417 INFO GET /api/timeseries 200 127.0.0.1 5480
2025-10-20 00:04:35,424 INFO GET /api/timeseries 200 127.0.0.1 5480
2025-10-20 00:04:35,424 INFO GET /api/metrics 200 127.0.0.1 5480
2025-10-20 01:03:11,198 INFO GET /api/analyze 200 127.0.0.1 5480
2025-10-20 01:06:21,677 INFO OPTIONS /api/metrics 400 127.0.0.1 none
2025-10-20 01:06:21,678 INFO OPTIONS /api/timeseries 400 127.0.0.1 none
2025-10-20 01:06:26,316 INFO OPTIONS /api/analyze 400 127.0.0.1 none
2025-10-20 01:06:32,187 INFO OPTIONS /api/analyze 400 127.0.0.1 none
2025-10-20 01:06:36,036 INFO OPTIONS /api/analyze 400 127.0.0.1 none
2025-10-20 01:06:39,195 INFO OPTIONS /api/suggest 400 127.0.0.1 none
2025-10-20 17:36:26,594 INFO GET /apple-touch-icon-precomposed.png 404 127.0.0.1 none
2025-10-20 17:36:26,655 INFO GET /apple-touch-icon.png 404 127.0.0.1 none
